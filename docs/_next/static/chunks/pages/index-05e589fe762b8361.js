(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(433)}])},7709:function(a,b,c){"use strict";c.d(b,{Z:function(){return r}});var d=c(5893),e=c(7294),f=c(1664),g=c.n(f),h=c(1163),i=c(5005),j=c(9459),k=c(453),l=c.n(k),m=c(3854),n=c(6653),o=c(4184),p=c.n(o),q=(0,e.forwardRef)(function(a,b){var c=a.children,e=a.onClick;return(0,d.jsxs)(i.Z,{href:"",ref:b,onClick:function(a){a.preventDefault(),e(a)},size:"sm",variant:"lightBlue",className:p()(l().btnWlm,"w-100","d-flex","justify-content-between","align-items-center"),children:[(0,d.jsx)("span",{children:c}),(0,d.jsx)(m.r0I,{className:p()("ms-1")})]})});q.displayName="HairyMenu";var r=function(){(0,h.useRouter)().basePath;var a=(0,h.useRouter)(),b=function(b,c){b.preventDefault(),a.push(c),a.reload()};return(0,d.jsxs)(j.Z,{className:p()("mb-2"),autoClose:!0,children:[(0,d.jsxs)(j.Z.Toggle,{as:q,id:"dropdown-autoclose-false",children:["Wiki",(0,d.jsx)(n.OBE,{}),"Monuments"]}),(0,d.jsxs)(j.Z.Menu,{className:p()("w-100"),children:[(0,d.jsx)(j.Z.Item,{href:"/",onClick:function(a){return b(a,"/")},children:"Map"}),(0,d.jsx)(g(),{href:"/list",passHref:!0,children:(0,d.jsx)(j.Z.Item,{children:"List"})}),(0,d.jsx)(g(),{href:"/about",passHref:!0,children:(0,d.jsx)(j.Z.Item,{children:"About"})}),(0,d.jsx)(j.Z.Item,{href:"https://www.wikimedia.it/wiki-loves-monuments/",children:"WikiLovesMonuments"}),(0,d.jsx)(j.Z.Header,{children:"Contests"}),(0,d.jsx)(j.Z.Item,{href:"/#selectedRegion=Umbria&dateFrom=2022-09-01&dateTo=2022-09-30",onClick:function(a){return b(a,"/#selectedRegion=Umbria&dateFrom=2022-09-01&dateTo=2022-09-30")},children:"2022: Castelli e fortificazioni"}),(0,d.jsx)(j.Z.Item,{href:"/#selectedRegion=Umbria&dateFrom=2021-09-01&dateTo=2021-09-30",onClick:function(a){return b(a,"/#selectedRegion=Umbria&dateFrom=2021-09-01&dateTo=2021-09-30")},children:"Concorso 2021"}),(0,d.jsx)(j.Z.Item,{href:"/#selectedRegion=Umbria&dateFrom=2020-09-01&dateTo=2020-09-30",onClick:function(a){return b(a,"/#selectedRegion=Umbria&dateFrom=2020-09-01&dateTo=2020-09-30")},children:"Concorso 2020"})]})]})}},947:function(a,b,c){"use strict";c.d(b,{Z:function(){return p}});var d=c(4924),e=c(5893),f=c(1664),g=c.n(f),h=c(1163),i=c(5738),j=c(5498),k=c(4184),l=c.n(k),m=c(2371),n=c.n(m),o=JSON.parse('[{"label":"Home","url":"/","menues":["main","footer"]},{"label":"Page","url":"/page","menues":["main","footer"]}]');function p(){var a=(0,h.useRouter)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(i.Z,{className:l()(n().navbar,"px-3"),sticky:"top",expand:"lg",children:[(0,e.jsx)(g(),{href:"/",children:(0,e.jsx)("a",{className:l()(n().logo,"no-hover"),children:"Project Title"})}),(0,e.jsx)(i.Z.Toggle,{"aria-controls":"abilitiamo-main-navbar"}),(0,e.jsx)(i.Z.Collapse,{children:(0,e.jsx)(j.Z,{className:l()("ms-auto","align-items-left"),children:o.filter(function(a){return a.menues.indexOf("main")> -1}).map(function(b){return(0,e.jsx)(g(),{href:b.url,children:(0,e.jsx)("a",{className:l()("nav-link","no-hover",n().item,(0,d.Z)({},"".concat(n().active),a.pathname==b.url),(0,d.Z)({},"".concat(n().specificPage),"/dona-ora"===b.url)),children:b.label})},b.label)})})})]})})}},433:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return a6}});var d=c(5893),e=c(9008),f=c.n(e);c(947);var g=c(6042),h=c(828),i=c(8804),j=c.n(i),k=c(7294),l=c(1163),m=c(2992),n=c(682),o=c(1608),p=c(1555),q=c(4184),r=c.n(q),s=c(9459),t=c(5005),u=c(3750),v=c(1174),w=c.n(v);function x(a){var b=a.label,c=a.items,e=a.value,f=a.setValue,g=a.defaultLabel,h=a.disabled;return(0,d.jsxs)("div",{className:r()("d-flex","justify-content-start","align-items-center","mb-2"),children:[b&&(0,d.jsx)("span",{children:b}),(0,d.jsxs)(s.Z,{className:r()({"ms-1":b}),children:[(0,d.jsxs)(s.Z.Toggle,{className:r()(w().btnWlm),id:"dropdown-basic",size:"sm",variant:"lightBlue",disabled:h,children:[e&&e.label,!e&&g]}),(0,d.jsx)(s.Z.Menu,{style:{maxHeight:"50vh",overflowY:"auto"},children:c.map(function(a,b){return(0,d.jsx)(s.Z.Item,{eventKey:b,onClick:function(){f(a)},children:a.label},b)})})]}),e&&(0,d.jsx)(t.Z,{className:r()("ms-1",w().btnWlm),size:"sm",variant:"lightBlue",onClick:function(){f(void 0)},disabled:h,children:(0,d.jsx)(u.C7Q,{})})]})}x.defaultProps={transferSelection:function(a){return console.warn("No function specified for rtansferring the selection to parent. Value:",a)},defaultLabel:"Select an item",items:[{label:"action 1"},{label:"action 2"},{label:"action 3"},{label:"action 4"}]};var y=c(2914);function z(a){var b=a.label,c=a.value,e=a.transferSelection,f=a.min,g=a.max;return(0,d.jsxs)(y.Z.Group,{controlId:"date",className:r()("d-flex","justify-content-start","align-items-center","mb-2"),children:[b&&(0,d.jsx)(y.Z.Label,{children:b}),(0,d.jsx)(y.Z.Control,{className:r()({"ms-1":b}),type:"date",name:"date",min:f,max:g,placeholder:"Pick a date",value:c,size:"sm",variant:"lightBlue",onChange:function(a){return e(a.target.value)}})]})}function A(a){var b=a.label,c=a.onClickAction,e=a.content,f=a.disabled;return(0,d.jsxs)("div",{className:r()("d-flex","justify-content-start","align-items-center","mb-2"),children:[b&&(0,d.jsx)("span",{children:b}),(0,d.jsx)(t.Z,{className:r()(w().btnWlm,{"ms-1":b}),size:"sm",variant:"lightBlue",onClick:function(a){return c(a)},disabled:f,children:e})]})}z.defaultProps={value:"2012-01-01",transferSelection:function(a){return console.warn("No function specified for transferring the selection to parent. Value:",a)}},A.defaultProps={initialDate:"2012-01-01",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}};var B=c(2086);function C(a){var b=a.label,c=a.items,e=a.disabled;return(0,d.jsxs)("div",{className:r()("d-flex","justify-content-start","align-items-center","mb-2"),children:[b&&(0,d.jsx)("span",{children:b}),(0,d.jsx)(B.Z,{className:r()({"ms-1":b}),"aria-label":"Basic example",children:c.map(function(a,b){return(0,d.jsx)(t.Z,{size:"sm",variant:"lightBlue",onClick:function(b){return a.onClickAction(b)},disabled:e,children:a.content},b)})})]})}C.defaultProps={items:[{content:"btn",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}},{content:"btn",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}},{content:"btn",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}},]};var D=c(7709),E=c(9815),F=c(2846),G=c.n(F),H=c(9396),I={blueJeans:"#0978AB",lightBlue:"#DDF7FF",terrain:"#ECE5E0",terrainDark:"#A4988F",white:"#ffffff",onWIki:"#C3C5C3",inContest:"#F8FF0E",photographed:"#22B8B4",interactive:"#FF004D"},J=150,K=function(a,b){R=J/a.history.length,b.selectAll(".tickBg").data(function(a){return O(a).slice(0,1)},function(a){return a.code}).join("path").attr("d",function(a){var b;return M(0,0,a.outerRadius,-J/2,J/2)}).attr("stroke","none").attr("fill","url(#tick-background)").classed("tickBg",!0).lower(),b.selectAll(".bubble").data(function(a){return[a]},function(a){return a.code}).join("circle").attr("class","bubble").attr("fill",function(a){return I[a.history.slice(-1)[0].groups.reduce(function(a,b){return a.valueDelta>b.valueDelta?a:b}).label]}).attr("stroke","#fff").attr("r",4).attr("display","none"),b.selectAll(".snapshot").data(function(a){return a.history},function(a){return a.date}).join("g").attr("class","snapshot").attr("transform",function(a,b){return"rotate(".concat(-J/2+R*b,")")}).selectAll(".status").data(function(a){return a.groups},function(a){return a.label}).join(function(a){return a.append("path").attr("class","status").attr("fill",function(a){return I[a.label]}).attr("d",function(a){return N(a)})},function(a){return a.attr("fill",function(a){return I[a.label]}).attr("d",function(a){return N(a)})},function(a){return a.remove()}),b.selectAll(".label").data(function(a){return[a]},function(a){return a.code}).join("text").attr("text-anchor","middle").attr("font-size",10).attr("class","label").attr("y",12).text(function(a){return a.label||"Unknown Region"}).raise();var c=b.select(".ticks");c.empty()&&(c=b.append("g").classed("ticks",!0)),c.raise();var d=c.selectAll(".tick").data(function(a){return O(a)},function(a){return a.label+a.value}).join("g").attr("data-tick",function(a,b){return a.label+a.value}).classed("tick",!0);d.selectAll(".axis").data(function(a){return[a]},function(a){return a}).join("path").classed("axis",!0).attr("d",function(a){var b;return M(0,0,a.outerRadius,-J/2,J/2)}).attr("stroke","rgba(255,255,255,0.75)").attr("stroke-width",.5).attr("fill","none"),d.selectAll(".axisLabel").data(function(a){return[a]},function(a){return a}).join("text").classed("axisLabel",!0).attr("fill","#aaa").attr("font-size",7).attr("font-weight","bold").attr("x",function(a){var b=a.outerRadius,c=J/2;return c=a.index%2==0?c:-c,L(0,0,b,c).x}).attr("y",function(a){var b;return L(0,0,a.outerRadius,J/2).y+7}).attr("text-anchor",function(a){return a.index%2==0?"start":"end"}).text(function(a){return a.value})};function L(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}}function M(a,b,c,d,e){var f=L(a,b,c,e),g=L(a,b,c,d);return["M",f.x,f.y,"A",c,c,0,e-d<=180?"0":"1",0,g.x,g.y].join(" ")}function N(a){var b;if(0===a.innerRadius){var c=a.outerRadius,d=0,e=R-1,f=L(0,0,a.outerRadius,e),g=L(0,0,a.outerRadius,d),h=e-d<=180?"0":"1";b=["M",0,0,"L",f.x,f.y,"A",c,c,0,h,0,g.x,g.y,"Z"].join(" ")}else{var i=a.outerRadius,j=0,k=R-1,l=L(0,0,i,k),m=L(0,0,i,j),n=k-j<=180?"0":"1",o=a.innerRadius,p=0,q=R-1,r=L(0,0,o,q),s=L(0,0,o,p),t=q-p<=180?"0":"1";b=["M",r.x,r.y,"L",l.x,l.y,"A",i,i,0,n,0,m.x,m.y,"L",s.x,s.y,"A",o,o,0,t,1,r.x,r.y,"Z",].join(" ")}return b}function O(a){for(var b=function(a){var b=e[a];if(0===b.value)return"continue";var f=b.outerRadius,h=(0,H.Z)((0,g.Z)({},b),{index:a}),i=7;d.find(function(a){return a>=f-i&&a<=f+i})||(d.push(f),c.push(h))},c=[],d=[],e=a.history.slice(-1)[0].groups,f=e.length-1;f>=0;f--)b(f);return c}var P={onWIki:{explained:"Monuments on Wikidata"},inContest:{explained:"Monuments in contest"},photographed:{explained:"Photographed for the first time"}};function Q(a){var b=a.group,c=a.max,e=a.filterData,f=a.setFilterData,g=e.find(function(a){return b.label===a.label}).active,h=(0,k.useState)(g),i=h[0],j=h[1],l=(0,k.useState)(!1),m=l[0],n=l[1],o=(0,k.useMemo)(function(){return b.value[1]-b.value[0]},[b]),p=(0,k.useMemo)(function(){return o/c*100},[o,c]);return(0,k.useEffect)(function(){var a=(0,E.Z)(e);a.find(function(a){return b.label===a.label}).active=i,f(a)},[i]),(0,k.useEffect)(function(){j(e.find(function(a){return b.label===a.label}).active),n(e.filter(function(a){return a.active}).length<2&& !0===i)},[e]),(0,d.jsxs)("div",{className:r()(G().group),children:[(0,d.jsx)("input",{name:b.label,type:"checkbox",checked:i,onChange:function(){return j(!i)},disabled:m}),(0,d.jsxs)("span",{className:r()(G().bar),children:[(0,d.jsx)("div",{style:{backgroundColor:I[b.label],width:"".concat(p,"%")}}),(0,d.jsxs)("span",{className:r()(G().amount),children:[o>=0?"+":"",o]})]}),(0,d.jsx)("span",{className:r()(G().explained),children:P[b.label].explained})]})}var R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an=function(a){var b=a.data,c=a.filterData,e=a.setFilterData,f=(0,k.useState)(),g=f[0],h=f[1];return(0,k.useEffect)(function(){h((0,m.Fp7)(b.extent.map(function(a){return a.value[1]-a.value[0]})))},[b]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("h6",{children:"What's new"}),(0,d.jsx)("div",{className:"mb-3",children:b.extent.map(function(a,b){return(0,d.jsx)(Q,{group:a,max:g,filterData:c,setFilterData:e},b)})})]})},ao=c(7211),ap=c.n(ao),aq={left:20,right:1,top:30,bottom:20},ar=m.Xf(),as=m.BYU(),at=function(a){(X=(S=m.Ys(a)).select(".quantityAxisGroup")).empty()&&(X=S.append("g").classed("quantityAxisGroup",!0)),(V=S.selectAll(".areaChart")).empty()&&(V=S.append("g").classed("areaChart",!0)),(W=S.select(".timeAxisGroup")).empty()&&(W=S.append("g").classed("timeAxisGroup",!0))},au=function(a,b){var c=S.node().getBoundingClientRect();T=c.width,U=c.height;var d=[],e=new Set,f=[],g=[],i=b.filter(function(a){return a.active}).map(function(a){return a.label});a.data.forEach(function(a){a.history.forEach(function(a){var b=(0,h.Z)(a.date.split("-"),3),c=b[0],j=b[1],k=b[2],l=new Date(c,j-1,k);f.push(l);var m={date:l},n=a.groups.filter(function(a){return -1!==i.indexOf(a.label)});n.forEach(function(a,b){var c=a.value;b>0&&(c-=n[b-1].value),g.push(a.value),e.add(a.label),m[a.label]=c}),d.push(m)})});var j,k=m.knu().keys(Array.from(e)).order(m.Qxt).offset(m.HLf)(d),l=m.Wem(f);ar.domain(l).range([aq.left,T-aq.right]);var n=m.LLu(ar);W.attr("transform","translate(0, ".concat(U-aq.bottom,")")).call(n).call(function(a){a.select(".domain").remove()});var o=m.Wem(g);as.domain([0,o[1]]).range([U-aq.bottom,aq.top]),as.ticks(5);var p=as.tickFormat(5,"~s"),q=m.Khx(as.copy()).tickFormat(p),r=[];X.attr("transform","translate(".concat(0,",0)")).call(q).call(function(a){a.select(".domain").attr("display","none"),a.selectAll(".tick > text").attr("x",0).each(function(a){r.push(this.getComputedTextLength())}),a.selectAll(".tick > line").attr("stroke-dasharray","1, 4").attr("x1",Math.ceil(m.Fp7(r))+4).attr("x2",T),a.selectAll(".tick").filter(function(a){return 0===a}).attr("display","none")});var s=m.SOn().x(function(a){return ar(a.data.date)}).y0(function(a){return as(a[0])}).y1(function(a){return as(a[1])}).curve(m.iJ);V.selectAll(".area").data(k).join("path").attr("class","area").attr("fill",function(a){return I[a.key]}).attr("d",s)},av=function(a){var b=a.data,c=a.filterData,e=(0,k.useRef)();return(0,k.useEffect)(function(){at(e.current)},[]),(0,k.useEffect)(function(){au(b,c)},[b,c]),(0,d.jsx)("div",{className:r()(ap().areaChart,"d-flex","justify-content-center","align-items-center"),children:(0,d.jsx)("svg",{ref:e})})},aw=c(6212),ax=c(4924),ay=c(5213),az=c.n(ay),aA=c(8576),aB=c.n(aA);m.A4v().force("x",m.RUJ(function(a){return a.x})).force("y",m.Mrm(function(a){return a.y})).on("tick",aL).stop();var aC,aD,aE=1,aF=1,aG=void 0,aH=m.vY$(),aI=function(a,b){var c=b.lvl4,d=(Y=m.Ys(a)).node().getBoundingClientRect();Z=d.width,$=d.height,b.viewbox&&(Z=b.viewbox.width,$=b.viewbox.height,Y.attr("viewBox","0 0 ".concat(b.viewbox.width," ").concat(b.viewbox.height))),_=Y.select(".bgRect"),_.empty()&&(_=Y.append("rect").classed("bgRect",!0)),_.attr("fill",I.lightBlue).attr("width","100%").attr("height","100%").attr("pointer-events","none"),ad=Y.select(".main-g"),ad.empty()&&(ad=Y.append("g").classed("main-g",!0)),ae=ad.select(".g_geographies"),ae.empty()&&(ae=ad.append("g").classed("g_geographies",!0)),af=ae.select(".regions"),af.empty()&&(af=ae.append("g").classed("regions",!0)),ah=ae.select(".provinces"),ah.empty()&&(ah=ae.append("g").classed("provinces",!0)),aj=ae.select(".municipalities"),aj.empty()&&(aj=ae.append("g").classed("municipalities",!0)),al=ad.select(".g_ventagli"),al.empty()&&(al=ad.append("g").classed("g_ventagli",!0)),am=al.selectAll(".ventaglio"),aa=m.mw4().fitSize([Z,$],{type:"FeatureCollection",features:c}),ab=m.l49(aa),ac=m.sPX().scaleExtent([1,1024]).extent([[0,0],[Z,$],]).on("zoom",function(a){return aK(a.transform)}).on("end",function(){am.call(aN)}),Y.call(ac),aJ(b)},aJ=function(a){var b,c=function(a){if(a){var b=(0,h.Z)(ab.bounds(a),2),c=(0,h.Z)(b[0],2),d=c[0],e=c[1],f=(0,h.Z)(b[1],2),g=f[0],i=f[1],j=("municipality"===aG?.25:1)/Math.max((g-d)/Z,(i-e)/$);Y.call(ac.transform,m.CRH.translate(Z/2,$/2).scale(j).translate(-(d+g)/2,-(e+i)/2))}else Y.call(ac.transform,m.CRH)},d=a.data,e=a.extent,f=a.lvl4,g=a.lvl6,i=a.lvl8,j=a.selectedRegion,k=a.selectedProvince,l=a.selectedMunicipality,n=a.setSelectedRegion,o=a.setSelectedProvince,p=a.setSelectedMunicipality;a.viewbox&&(Z=a.viewbox.width,$=a.viewbox.height,Y.attr("viewBox","0 0 ".concat(a.viewbox.width," ").concat(a.viewbox.height))),aH.exponent(.5).domain([0,m.Fp7(e.map(function(a){return a.value[1]}))]).range([0,70]),ag=af.selectAll(".region").data(f,function(a){return a.properties.code}).join("path").attr("class","region").attr("fill",I.terrain).attr("stroke",I.terrainDark).attr("stroke-width","var(--stroke-width)").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("d",function(a){return ab(a)}).on("click",function(a,b){a.stopPropagation();var c=b.properties,d=c.code,e=c.label;p(void 0),o(void 0),n({code:d,label:e})}),ai=ah.selectAll(".province").data(g,function(a){return a.properties.code}).join("path").attr("class","province").attr("fill",I.terrain).attr("stroke",I.terrainDark).attr("stroke-width","var(--stroke-width)").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("d",function(a){return ab(a)}).on("click",function(a,b){a.stopPropagation();var c=b.properties,d=c.code,e=c.label;p(void 0),o({code:d,label:e})}),ak=aj.selectAll(".municipality").data(i,function(a){return a.properties.code}).join("path").attr("class","municipality").attr("fill",I.terrain).attr("stroke",I.terrainDark).attr("stroke-width","var(--stroke-width)").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("d",function(a){return ab(a)}).on("click",function(a,b){if(a.stopPropagation(),l)p(void 0);else{var c=b.properties,d=c.code,e=c.label,f={code:d,label:e};p(f)}}),l?(console.log("a municipality"),b=i,aG="municipality",aF=35,ag.attr("opacity",.5),ai.attr("opacity",.5),ak.attr("display","none").filter(function(a){return a.properties.code===l.code}).attr("display","block").each(c)):k?(console.log("a province"),b=i,aG="province",aF=35,ag.attr("opacity",.5),ai.attr("opacity",.5).filter(function(a){return a.properties.code===k.code}).attr("opacity",1).each(c),ak.attr("display","block")):j?(console.log("a region"),b=g,aG="region",aF=35,ag.attr("opacity",.5).filter(function(a){return a.properties.code===j.code}).attr("opacity",1).each(c),ak.attr("display","block")):(console.log("all Italy"),b=f,aG=void 0,aF=1.4,ag.attr("opacity",1),ai.attr("opacity",1),ak.attr("opacity",1),c(void 0)),d=aM(d,b),am=al.selectAll(".ventaglio").data(d,function(a){return a.code}).join("g").attr("class","ventaglio").classed("overlapping",!1).on("click",function(a,b){if("municipality"===aG)console.log("Clicked.",b),p(void 0);else if("province"===aG){var c=b.code,d=b.label,e={code:c,label:d};p(e)}else if("region"===aG){var f=b.code,g=b.label,h={code:f,label:g};o(h)}else{var i=b.code,j=b.label,k={code:i,label:j};n(k)}}).each(function(a){K(a,m.Ys(this))}),aL()};function aK(a){ad.attr("transform",a);var b=a.x,c=a.y,d=a.k;aC=b,aD=c,aE=d,document.documentElement.style.setProperty("--stroke-width",1/d),am.attr("transform",function(a){return"translate(".concat(a.x,", ").concat(a.y,") scale(").concat(1/(d>=aF?aF:d),")")})}function aL(){am.attr("transform",function(a){return"translate(".concat(a.x,", ").concat(a.y,") scale(").concat(1/(aE>=aF?aF:aE),")")})}function aM(a,b){return a.forEach(function(a){var c=b.find(function(b){return b.properties.code===a.code});if(c){var d=aa(c.properties.centroid.coordinates);a.x=d[0],a.y=d[1]}else{var e=aa([12.4,39.3]);a.x=e[0],a.y=e[1]}a.maxRadius=aH(a.maxValue),a.history.forEach(function(a){var b=a.groups;a.groups.forEach(function(c,d){c.innerRadius=0===d?0:a.groups[d-1].outerRadius,c.outerRadius=aH(c.value),c.valueDelta=0==d?c.value:c.value-b[d-1].value})})}),a}function aN(a){aG&&"region"!==aG&&(a.classed("overlapping",!1),a.selectAll(".bubble").attr("display","none"),a.selectAll("*:not(.bubble)").attr("display","block"),a.each(function(b){var c=this;a.each(function(a){if(a!==b){var d=aO([b.x,b.y],[a.x,a.y]),e=b.history.slice(-1)[0].groups.slice(-1)[0].outerRadius,f=a.history.slice(-1)[0].groups.slice(-1)[0].outerRadius,g=(e+f)/aE*.7;if(d<g){var h,i=m.Ys(c),j=m.Ys(this);if(i.classed("overlapping")||j.classed("overlapping"))return;(h=b.maxValue<a.maxValue?m.Ys(c):m.Ys(this)).classed("overlapping",!0),h.selectAll(".bubble").attr("display","block"),h.selectAll("*:not(.bubble)").attr("display","none")}}})}))}function aO(a,b){var c=(0,h.Z)(a,2),d=c[0],e=c[1],f=(0,h.Z)(b,2),g=f[0],i=f[1],j=g-d,k=i-e;return Math.sqrt(j*j+k*k)}function aP(a){var b=a.ventagli,c=a.lvl4,e=a.lvl6,f=a.lvl8,g=a.selectedRegion,h=a.selectedProvince,i=a.selectedMunicipality,j=a.setSelectedRegion,l=a.setSelectedProvince,m=a.setSelectedMunicipality,n=a.typology,o=a.dateFrom,p=a.dateTo,q=a.viewbox,s=(0,k.useRef)(),t=b.data,u=b.extent;return(0,k.useEffect)(function(){aI(s.current,{data:t,extent:u,lvl4:c,lvl6:e,lvl8:f,selectedRegion:g,selectedProvince:h,selectedMunicipality:i,setSelectedRegion:j,setSelectedProvince:l,setSelectedMunicipality:m,typology:n,dateFrom:o,dateTo:p,viewbox:q})},[]),(0,k.useEffect)(function(){aJ({data:t,extent:u,lvl4:c,lvl6:e,lvl8:f,selectedRegion:g,selectedProvince:h,selectedMunicipality:i,setSelectedRegion:j,setSelectedProvince:l,setSelectedMunicipality:m,typology:n,dateFrom:o,dateTo:p,viewbox:q})},[b,g,h,i,q]),(0,d.jsx)("div",{className:r()(aB().map,"position-relative"),children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",ref:s,children:(0,d.jsxs)("linearGradient",{id:"tick-background",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[(0,d.jsx)("stop",{offset:"0%",stopColor:"rgb(255,255,255)",stopOpacity:"0.75"}),(0,d.jsx)("stop",{offset:"100%",stopColor:"rgb(255,255,255)",stopOpacity:"0"})]})})})}function aQ(){return(0,d.jsx)("div",{className:r()(aB().map,aB().placeholder,"position-relative")})}function aR(a){var b=a.closeFunct,c=a.mapData,e={mobile:{width:400,height:500},computer:{width:1280,height:720}},f=(0,k.useState)("mobile"),h=f[0],i=f[1],j=(0,k.useState)(e.mobile),l=j[0],m=j[1],n=function(){console.log("download svg");var a=document.querySelector(".".concat(az().exportTools," svg")).outerHTML,b=document.createElement("a");b.setAttribute("href","data:text/svg;charset=utf-8,"+encodeURIComponent(a)),b.setAttribute("download","WLM.svg"),b.style.display="none",document.body.appendChild(b),b.click(),document.body.removeChild(b)};return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:r()(az().exportTools,"d-flex","flex-column","align-items-center","justify-content-between","p-3"),children:[(0,d.jsx)("div",{className:r()(az().preview,(0,ax.Z)({},az().computer,"computer"===h),(0,ax.Z)({},az().mobile,"mobile"===h),"mb-3"),children:(0,d.jsx)(aP,(0,H.Z)((0,g.Z)({},c),{viewbox:l}))}),(0,d.jsxs)("div",{className:r()("w-100","d-flex","flex-row","justify-content-between"),children:[(0,d.jsxs)("span",{className:r()("d-flex","flex-row","justify-content-center"),style:{flex:"1 1 0px"},children:[(0,d.jsx)(A,{content:(0,d.jsx)(u.C7Q,{}),onClickAction:b}),(0,d.jsx)("span",{children:"Export snapshot"})]}),(0,d.jsxs)("span",{className:r()("d-flex","flex-row","justify-content-center"),style:{flex:"1 1 0px"},children:[(0,d.jsx)(A,{content:(0,d.jsx)(u.me1,{}),onClickAction:function(){m(e.mobile),i("mobile")}}),(0,d.jsx)(A,{content:(0,d.jsx)(u.HSC,{}),onClickAction:function(){m(e.computer),i("computer")}})]}),(0,d.jsx)("span",{className:r()("d-flex","flex-row","justify-content-center"),style:{flex:"1 1 0px"},children:(0,d.jsx)(A,{label:"Save SVG",content:(0,d.jsx)(u.QNI,{}),onClickAction:n})})]})]})})}function aS(a){var b=a.regions,c=a.selectedRegion,e=a.setSelectedRegion,f=a.provinces,g=a.selectedProvince,h=a.setSelectedProvince,i=a.municipalities,j=a.selectedMunicipality,l=a.setSelectedMunicipality,m=a.typologiesList,n=a.typology,o=a.setTypology,p=a.minDate,q=a.dateFrom,s=a.setDateFrom,t=a.maxDate,v=a.dateTo,y=a.setDateTo,B=a.timeStep,E=a.parentData,F=a.filterData,G=a.setFilterData,H=a.mapData,I=(0,k.useState)(!1),J=I[0],K=I[1];return(0,d.jsxs)("div",{className:r()(w().toolBar,"d-flex","flex-column"),children:[(0,d.jsx)(D.Z,{}),(0,d.jsx)("h6",{children:"Monuments"}),(0,d.jsx)(x,{label:"Region",items:b.items,value:c,setValue:e,defaultLabel:"Select a region",disabled:b.disabled||g}),(0,d.jsx)(x,{label:"Province",items:f.items,value:g,setValue:h,defaultLabel:"Select a province",disabled:f.disabled||j}),(0,d.jsx)(x,{label:"Municipality",items:i.items,value:j,setValue:l,defaultLabel:"Select a municipality",disabled:i.disabled}),(0,d.jsx)(x,{label:"Type",items:m,value:n,setValue:o,disabled:!m}),(0,d.jsx)(z,{label:"From",min:p,max:v,value:q,transferSelection:s}),(0,d.jsx)(z,{label:"To",min:q,max:t,value:v,transferSelection:y}),(0,d.jsxs)("p",{className:r()("text-small"),children:[B,(0,d.jsx)("br",{}),"Last database snapshot: ",t]}),E&&F&&(0,d.jsx)(an,{data:E,filterData:F,setFilterData:G}),(0,d.jsx)("h6",{children:"Timeline"}),(0,d.jsxs)("div",{className:r()("d-flex","justify-content-between"),children:[(0,d.jsx)(C,{label:"Play",items:[{content:(0,d.jsx)(u.mz0,{}),onClickAction:function(a){return console.log(a)}},{content:"0.5X",onClickAction:function(a){return console.log(a)}},{content:"1X",onClickAction:function(a){return console.log(a)}},{content:"2X",onClickAction:function(a){return console.log(a)}},{content:(0,d.jsx)(u.cAs,{}),onClickAction:function(a){return console.log(a)}},],disabled:!0}),(0,d.jsx)(A,{label:"Save",content:(0,d.jsx)(u.QNI,{}),onClickAction:function(){return K(!0)},disabled:!1}),(0,d.jsx)(aw.Z,{size:"xl",centered:!0,show:J,onHide:function(){return K(!1)},children:(0,d.jsx)(aR,{closeFunct:function(){return K(!1)},mapData:H})})]}),E&&F&&(0,d.jsx)(av,{data:E,filterData:F})]})}var aT=c(7820),aU=c.n(aT),aV=c(6968);function aW(){return(0,d.jsxs)("div",{className:r()(aU().fetching,"position-absolute","d-flex","flex-column","justify-content-center","align-items-center"),children:[(0,d.jsx)(aV.Z,{variant:"blue-jeans",animation:"border",role:"status",size:"sm",children:(0,d.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,d.jsx)("p",{className:r()("position-relative"),style:{color:"var(--bs-blue-jeans)"},children:"Fetching Data"})]})}var aX=c(8565),aY=aX.DateTime,aZ=aX.Interval,a$="https://wlm.inmagik.com",a_="force-cache",a0="force-cache",a1=function(a,b,c,d,e){var f=a.selectedRegion,g=a.selectedProvince,i=a.selectedMunicipality,j=a.typology,k=a.dateFrom,l=a.dateTo;d(!0);var n=a$,o=a$;if(i?(n+="/api/municipality/".concat(i.code,"/wlm/"),o+="/api/municipality/".concat(i.code,"/wlm/")):g?(n+="/api/province/".concat(g.code,"/wlm-areas/"),o+="/api/province/".concat(g.code,"/wlm/")):f?(n+="/api/region/".concat(f.code,"/wlm-areas/"),o+="/api/region/".concat(f.code,"/wlm/")):(n+="/api/region/wlm-regions/",o+="/api/region/wlm-aggregate"),n){var p,q,r=aY.fromISO(k),s=aY.fromISO(l),t=aZ.fromDateTimes(r,s),u=15;31>=Math.ceil(t.length("days")/1)?(q="days",p=1):Math.ceil(t.length("days")/5)<=u?(q="days",p=5):Math.ceil(t.length("days")/10)<=u?(q="days",p=10):Math.ceil(t.length("months")/1)<=u?(q="months",p=1):Math.ceil(t.length("months")/3)<=u?(q="months",p=3):Math.ceil(t.length("months")/4)<=u?(q="months",p=4):Math.ceil(t.length("months")/6)<=u?(q="months",p=6):(q="years",p=1);var v=["Showing ",Math.ceil(t.length(q)/p)," history points (every ",p," ",q,")",].join("");e(v);var w={step_size:p,step_unit:q};w.date_from=k,w.date_to=l,j&&(w.theme=j.id),w.format="json";var x=new URLSearchParams(w).toString();n+="?"+x,o+="?"+x,Promise.all([(0,m.AVB)(n,{cache:a_}),(0,m.AVB)(o,{cache:a_}),]).then(function(a){var e=(0,h.Z)(a,2),f=e[0],g=e[1];b(f),c(g),d(!1)})}},a2=c(9226),a3=c.n(a2);function a4(){return(0,d.jsxs)("p",{className:r()("text-small",a3().licenseAttribution),children:[(0,d.jsxs)("a",{className:r()("d-flex","me-1"),rel:"license",href:"http://creativecommons.org/licenses/by/4.0/",children:[(0,d.jsx)("img",{className:r()("me-1"),alt:"Licenza Creative Commons",style:{borderWidth:0,maxHeight:"1rem"},src:"https://mirrors.creativecommons.org/presskit/icons/cc.svg"}),(0,d.jsx)("img",{alt:"Licenza Creative Commons",style:{borderWidth:0,maxHeight:"1rem"},src:"https://mirrors.creativecommons.org/presskit/icons/by.svg"})]}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",(0,H.Z)((0,g.Z)({},{"xmlns:dct":"http://purl.org/dc/terms/"}),{href:"http://purl.org/dc/dcmitype/InteractiveResource",rel:"dct:type",children:"Work"}))," ","by"," ",(0,d.jsx)("span",(0,H.Z)((0,g.Z)({},{"xmlns:cc":"http://creativecommons.org/ns#"}),{property:"cc:attributionName",children:"DensityDesign (Politecnico di Milano) & Wikimedia Italia."}))," ","License:"," ",(0,d.jsx)("a",{rel:"license",href:"http://creativecommons.org/licenses/by/4.0/",children:"Creative Commons Attribution 4.0 International"})]})]})}var a5=function(){var a=(0,l.useRouter)().asPath,b=(0,k.useState)(!0),c=b[0],e=b[1],f=(0,k.useState)(!1),i=f[0],q=f[1],s=(0,k.useState)(),t=s[0],u=s[1],v=(0,k.useState)(),w=v[0],x=v[1],y=(0,k.useState)(),z=y[0],A=y[1],B=(0,k.useState)([]),C=B[0],D=B[1],E=(0,k.useState)([]),F=E[0],G=E[1],H=(0,k.useState)([]),I=H[0],J=H[1],K=(0,k.useState)([]),L=K[0],M=K[1],N=(0,k.useState)([]),O=N[0],P=N[1],Q=(0,k.useState)([]),R=Q[0],S=Q[1],T=(0,k.useState)([]),U=T[0],V=T[1],W=(0,k.useState)(),X=W[0],Y=W[1],Z=(0,k.useState)(),$=Z[0],_=Z[1],aa=(0,k.useState)(),ab=aa[0],ac=aa[1],ad=(0,k.useState)(),ae=ad[0],af=ad[1],ag=(0,k.useState)("2012-01-01"),ah=ag[0];ag[1];var ai=(0,k.useState)(),aj=ai[0],ak=ai[1],al=(0,k.useState)(),am=al[0],an=al[1],ao=(0,k.useState)(),ap=ao[0],aq=ao[1],ar=(0,k.useState)(),as=ar[0],at=ar[1];(0,k.useEffect)(function(){Promise.all([m.AVB(a$+"/api/region/geo/?format=json",{cache:a0}),m.AVB(a$+"/api/domain/?format=json",{cache:a_}),]).then(function(b){var c=(0,h.Z)(b,2),d=c[0],f=c[1];an(f.last_snapshot);var g=f.themes;V(g),D(d.features);var i=d.features.map(function(a){return{label:a.properties.name,code:a.properties.code}});M(i);var j=a.split("#")[1],k={};j&&(k=Object.fromEntries(j.split("&").map(function(a){return a.split("=").map(function(a){return decodeURIComponent(a)})})));var l=k.typology,n=k.dateFrom,o=k.dateTo,p=k.selectedRegion,q=k.selectedProvince,r=k.selectedMunicipality,s=k.filterDataParams;if(l&&af(g.find(function(a){return a.id==l})),n?ak(n):ak(ah),o?aq(o):aq(f.last_snapshot),s&&A(s.split(";").map(function(a){return a.split(":")}).map(function(a){return{label:a[0],active:"true"===a[1]}})),p){var t=i.find(function(a){return a.label===p});Y(t),m.AVB(a$+"/api/region/".concat(t.code,"/areas/?format=json"),{cache:a0}).then(function(a){G(a.features);var b=a.features.map(function(a){return{label:a.properties.name,code:a.properties.code}});if(P(b),q){var c=b.find(function(a){return a.label===q});_(c),m.AVB(a$+"/api/province/".concat(c.code,"/areas/?format=json"),{cache:a0}).then(function(a){J(a.features);var b=a.features.map(function(a){return{label:a.properties.name,code:a.properties.code}});S(b),r&&ac(b.find(function(a){return a.label===r})),e(!1)})}else e(!1)})}else e(!1)}).catch(function(a){console.error("Error:",a)})},[]),(0,k.useEffect)(function(){X&&!c?m.AVB(a$+"/api/region/".concat(X.code,"/areas/?format=json")).then(function(a){G(a.features),P(a.features.map(function(a){return{label:a.properties.name,code:a.properties.code}}))}):(G([]),P([]))},[X]),(0,k.useEffect)(function(){$&&!c?m.AVB(a$+"/api/province/".concat($.code,"/areas/?format=json")).then(function(a){J(a.features),S(a.features.map(function(a){return{label:a.properties.name,code:a.properties.code}}))}):(J([]),S([]))},[$]),(0,k.useEffect)(function(){if(w){var a=w.extent.map(function(a){var b=!0;return z&&(b=z.find(function(b){return b.label===a.label}).active),{label:a.label,active:b}});A(a)}},[w]),(0,k.useEffect)(function(){var a={},b={};X&&(a.selectedRegion=encodeURIComponent(X.label),b.selectedRegion=X),$&&(a.selectedProvince=encodeURIComponent($.label),b.selectedProvince=$),ab&&(a.selectedMunicipality=encodeURIComponent(ab.label),b.selectedMunicipality=ab),ae&&(a.typology=encodeURIComponent(ae.id),b.typology=ae),aj&&(a.dateFrom=encodeURIComponent(aj),b.dateFrom=aj),ap&&(a.dateTo=encodeURIComponent(ap),b.dateTo=ap);var d=[];for(var e in a)d.push(e+"="+a[e]);var f="#"+d.join("&");location.replace(f),c||a1(b,u,x,q,at)},[X,$,ab,ae,aj,ap,c]),(0,k.useEffect)(function(){if(z){var a=Object.fromEntries(location.hash.split("#")[1].split("&").map(function(a){return a.split("=").map(function(a){return decodeURIComponent(a)})}));a.filterDataParams=encodeURIComponent(z.map(function(a){return a.label+":"+a.active.toString()}).join(";"));var b=[];for(var c in a)b.push(c+"="+a[c]);var d="#"+b.join("&");location.replace(d)}},[z]);var au=(0,k.useMemo)(function(){if(z&&t){var a=JSON.parse(JSON.stringify(t));return z.filter(function(a){return!a.active}).forEach(function(b){a.data.forEach(function(a){a.history.forEach(function(a){var c=a.groups,d=c.find(function(a){return a.label===b.label}),e=c.indexOf(d);e> -1&&c.splice(e,1)})});var c=a.extent.find(function(a){return a.label===b.label}),d=a.extent.indexOf(c);d> -1&&a.extent.splice(d,1)}),a}},[z,t]),av={ventagli:au,lvl4:C,lvl6:F,lvl8:I,selectedRegion:X,setSelectedRegion:Y,selectedProvince:$,setSelectedProvince:_,selectedMunicipality:ab,setSelectedMunicipality:ac,typology:ae,dateFrom:aj,dateTo:ap,isFetching:i};return(0,d.jsx)(n.Z,{className:r()(j().vizController),fluid:!0,children:(0,d.jsxs)(o.Z,{className:r()("h-100"),children:[(0,d.jsx)(p.Z,{className:r()("h-100","pe-sm-3","pe-md-0"),lg:3,children:(0,d.jsx)(aS,{regions:{items:L,disabled:!L.length},selectedRegion:X,setSelectedRegion:Y,provinces:{items:O,disabled:!O.length},selectedProvince:$,setSelectedProvince:_,municipalities:{items:R,disabled:!R.length},selectedMunicipality:ab,setSelectedMunicipality:ac,typologiesList:U,typology:ae,setTypology:af,minDate:ah,dateFrom:aj,setDateFrom:ak,maxDate:am,dateTo:ap,setDateTo:aq,timeStep:as,parentData:w,filterData:z,setFilterData:A,mapData:av})}),(0,d.jsx)(p.Z,{className:r()("h-100","position-relative"),children:(0,d.jsxs)(d.Fragment,{children:[!c&&au&&(0,d.jsx)(aP,(0,g.Z)({},av)),!(!c&&au)&&(0,d.jsx)(aQ,{}),(0,d.jsx)(a4,{}),(c||i)&&(0,d.jsx)(aW,{})]})})]})})};function a6(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f(),{children:(0,d.jsx)("title",{children:"Home"})}),(0,d.jsx)(a5,{})]})}},7211:function(a){a.exports={areaChart:"AreaChart_areaChart__qAbnb"}},5213:function(a){a.exports={exportTools:"ExportTools_exportTools__meuDA",preview:"ExportTools_preview__evsuJ",mobile:"ExportTools_mobile__Ckt_9",computer:"ExportTools_computer__JHkYm"}},7820:function(a){a.exports={fetching:"Fetching_fetching__EY3MZ",bgAnimation:"Fetching_bgAnimation__x3WK0"}},9226:function(a){a.exports={licenseAttribution:"LicenseAttribution_licenseAttribution___r1PW"}},8576:function(a){a.exports={map:"MapVentagli_map__NmyTz",placeholder:"MapVentagli_placeholder__KtaV5"}},453:function(a){a.exports={btnWlm:"NavMenu_btnWlm___ociY"}},2371:function(a){a.exports={navbar:"Navigation_navbar__clCa1",logo:"Navigation_logo__AbP0d",item:"Navigation_item__j_Te9",specificPage:"Navigation_specificPage__k2gFH"}},1174:function(a){a.exports={toolBar:"UI-Components_toolBar__KROSq",btnWlm:"UI-Components_btnWlm__51KGY"}},8804:function(a){a.exports={vizController:"VisualizationController_vizController__KxPt2"}},2846:function(a){a.exports={group:"WhatsNew_group__mJ_bs",bar:"WhatsNew_bar__Y8vj9",amount:"WhatsNew_amount__QWQbL",explained:"WhatsNew_explained__LsAxI"}}},function(a){a.O(0,[556,13,225,831,381,85,962,774,888,179],function(){var b;return a(a.s=5557)}),_N_E=a.O()}])