(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(7697)}])},947:function(a,b,c){"use strict";c.d(b,{Z:function(){return p}});var d=c(4924),e=c(5893),f=c(1664),g=c.n(f),h=c(1163),i=c(2711),j=c(5498),k=c(4184),l=c.n(k),m=c(2371),n=c.n(m),o=JSON.parse('[{"label":"Home","url":"/","menues":["main","footer"]},{"label":"Page","url":"/page","menues":["main","footer"]}]');function p(){var a=(0,h.useRouter)();return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(i.Z,{className:l()(n().navbar,"px-3"),sticky:"top",expand:"lg",children:[(0,e.jsx)(g(),{href:"/",children:(0,e.jsx)("a",{className:l()(n().logo,"no-hover"),children:"Project Title"})}),(0,e.jsx)(i.Z.Toggle,{"aria-controls":"abilitiamo-main-navbar"}),(0,e.jsx)(i.Z.Collapse,{children:(0,e.jsx)(j.Z,{className:l()("ms-auto","align-items-left"),children:o.filter(function(a){return a.menues.indexOf("main")> -1}).map(function(b){return(0,e.jsx)(g(),{href:b.url,children:(0,e.jsx)("a",{className:l()("nav-link","no-hover",n().item,(0,d.Z)({},"".concat(n().active),a.pathname==b.url),(0,d.Z)({},"".concat(n().specificPage),"/dona-ora"===b.url)),children:b.label})},b.label)})})})]})})}},7697:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return aK}});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=c(5893),E=c(9008),F=c.n(E);c(947);var G,H,I=c(603),J=c(8804),K=c.n(J),L=c(7294),M=c(1163),N=c(6100),O=c(4184),P=c.n(O),Q={},R={},S=N.PUr().range([1,87.5]),T=N.PKp(["mapped","authorized","photographed"],["#C3C5C3","#F8FF0E","#22B8B4"]);function U(a){return a.forEach(function(a){a[1].forEach(function(a){var b=a[1].find(function(a){return"photographed"===a.group});b.innerRadius=0,b.outerRadius=S(b.valueIncremental);var c=a[1].find(function(a){return"authorized"===a.group});c.innerRadius=b.outerRadius,c.outerRadius=S(c.valueIncremental);var d=a[1].find(function(a){return"mapped"===a.group});d&&(d.innerRadius=c.outerRadius,d.outerRadius=S(d.valueIncremental))})}),a}function V(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}}function W(a,b,c,d,e){var f=V(a,b,c,e),g=V(a,b,c,d);return["M",f.x,f.y,"A",c,c,0,e-d<=180?"0":"1",0,g.x,g.y].join(" ")}function X(a){var b;if(0===a.innerRadius){var c=a.outerRadius,d=0,e=j,f=V(0,0,a.outerRadius,e),g=V(0,0,a.outerRadius,d),h=e-d<=180?"0":"1";b=["M",0,0,"L",f.x,f.y,"A",c,c,0,h,0,g.x,g.y,"Z",].join(" ")}else{var i=a.outerRadius,k=0,l=j,m=V(0,0,i,l),n=V(0,0,i,k),o=l-k<=180?"0":"1",p=a.innerRadius,q=0,r=j,s=V(0,0,p,r),t=V(0,0,p,q),u=r-q<=180?"0":"1";b=["M",s.x,s.y,"L",m.x,m.y,"A",i,i,0,o,0,n.x,n.y,"L",t.x,t.y,"A",p,p,0,u,1,s.x,s.y,"Z",].join(" ")}return b}function Y(a,b){var c=arguments.length>2&& void 0!==arguments[2]&&arguments[2];if(c){var d=.1*G+Math.random()*G*.8,e=.1*H+Math.random()*H*.8;return"translate(".concat(d,", ").concat(e,")")}var f=b%R.columns*175+87.5+Q.left,g=175*Math.floor(b/R.columns)+87.5+Q.top;return"translate(".concat(f,",").concat(g,") rotate(",0,")")}function Z(a){var b=a[1][a[1].length-1][1][0].valueIncremental,c=null.filter(function(a){return a<=b}).length+ -1,d=null.slice(Math.max(0,c-3),c);return d.push(b),d}function $(a){return 1===a?"":a>=1e3?(a=(a/1e3).toFixed(1))+"K":a}var _=c(682),aa=c(1608),ab=c(1555),ac=c(5312),ad=c(5005),ae=c(3750),af=c(1174),ag=c.n(af);function ah(a){var b=a.label,c=a.items,d=a.value,e=a.setValue,f=a.defaultLabel,g=a.disabled;return(0,D.jsxs)("div",{className:P()("d-flex","justify-content-start","align-items-center","mb-3"),children:[b&&(0,D.jsx)("span",{children:b}),(0,D.jsxs)(ac.Z,{className:P()({"ms-2":b}),children:[(0,D.jsxs)(ac.Z.Toggle,{className:P()(ag().btnWlm),id:"dropdown-basic",size:"sm",disabled:g,children:[d&&d.label,!d&&f]}),(0,D.jsx)(ac.Z.Menu,{style:{maxHeight:"50vh",overflowY:"auto"},children:c.map(function(a,b){return(0,D.jsx)(ac.Z.Item,{eventKey:b,onClick:function(){e(a)},children:a.label},b)})})]}),d&&(0,D.jsx)(ad.Z,{className:P()("ms-1",ag().btnWlm),size:"sm",onClick:function(){e(void 0)},disabled:g,children:(0,D.jsx)(ae.C7Q,{})})]})}ah.defaultProps={transferSelection:function(a){return console.warn("No function specified for rtansferring the selection to parent. Value:",a)},defaultLabel:"Select an item",items:[{label:"action 1"},{label:"action 2"},{label:"action 3"},{label:"action 4"}]};var ai=c(2914);function aj(a){var b=a.label,c=a.value,d=a.transferSelection;return(0,D.jsxs)(ai.Z.Group,{controlId:"date",className:P()("d-flex","justify-content-start","align-items-center","mb-3"),children:[b&&(0,D.jsx)(ai.Z.Label,{children:b}),(0,D.jsx)(ai.Z.Control,{className:"ms-3",type:"date",name:"date",placeholder:"Pick a date",value:c,size:"sm",onChange:function(a){return d(a.target.value)}})]})}function ak(a){var b=a.label,c=a.onClickAction,d=a.content;return(0,D.jsxs)("div",{className:P()("d-flex","justify-content-start","align-items-center","mb-3"),children:[b&&(0,D.jsx)("span",{children:b}),(0,D.jsx)(ad.Z,{className:P()(ag().btnWlm,{"ms-3":b}),size:"sm",onClick:function(a){return c(a)},children:d})]})}aj.defaultProps={value:"2012-01-01",transferSelection:function(a){return console.warn("No function specified for rtansferring the selection to parent. Value:",a)}},ak.defaultProps={initialDate:"2012-01-01",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}};var al=c(2086);function am(a){var b=a.label,c=a.items;return(0,D.jsxs)("div",{className:P()("d-flex","justify-content-start","align-items-center","mb-3"),children:[b&&(0,D.jsx)("span",{children:b}),(0,D.jsx)(al.Z,{className:P()("ms-3"),"aria-label":"Basic example",children:c.map(function(a,b){return(0,D.jsx)(ad.Z,{size:"sm",onClick:function(b){return a.onClickAction(b)},children:a.content},b)})})]})}am.defaultProps={items:[{content:"btn",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}},{content:"btn",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}},{content:"btn",onClickAction:function(a){return console.warn("No function specified for onClickAction. Value:",a)}},]},c(1664);var an=c(453),ao=c.n(an),ap=c(3854),aq=c(6653),ar=(0,L.forwardRef)(function(a,b){var c=a.children,d=a.onClick;return(0,D.jsxs)(ad.Z,{href:"",ref:b,onClick:function(a){a.preventDefault(),d(a)},size:"sm",className:P()(ao().btnWlm,"w-100","d-flex","justify-content-between","align-items-center"),children:[(0,D.jsx)("span",{children:c}),(0,D.jsx)(ap.r0I,{className:P()("ms-1")})]})});ar.displayName="HairyMenu";var as=function(){return(0,D.jsxs)(ac.Z,{className:P()("mb-3"),autoClose:!0,children:[(0,D.jsxs)(ac.Z.Toggle,{as:ar,id:"dropdown-autoclose-false",children:["Wiki",(0,D.jsx)(aq.OBE,{}),"Monuments"]}),(0,D.jsxs)(ac.Z.Menu,{className:P()("w-100"),children:[(0,D.jsx)(ac.Z.Item,{href:"#",children:"About"}),(0,D.jsx)(ac.Z.Item,{href:"#",children:"WikiLovesMonuments"}),(0,D.jsx)(ac.Z.Header,{children:"Contests"}),(0,D.jsx)(ac.Z.Item,{href:"#",children:"2022: Castelli e fortificazioni"}),(0,D.jsx)(ac.Z.Item,{href:"#",children:"Concorso 2021"}),(0,D.jsx)(ac.Z.Item,{href:"#",children:"Concorso 2020"})]})]})};function at(a){var b=a.regions,c=a.selectedRegion,d=a.setSelectedRegion,e=a.provinces,f=a.selectedProvince,g=a.setSelectedProvince,h=a.municipalities,i=a.selectedMunicipality,j=a.setSelectedMunicipality,k=a.typologiesList,l=a.typology,m=a.setTypology,n=a.dateFrom,o=a.setDateFrom,p=a.dateTo,q=a.setDateTo;return(0,D.jsxs)("div",{className:ag().toolBar,children:[(0,D.jsx)(as,{}),(0,D.jsx)("h6",{children:"Monuments"}),(0,D.jsx)(ah,{label:"Region",items:b.items,value:c,setValue:d,defaultLabel:"Select a region",disabled:b.disabled||f}),(0,D.jsx)(ah,{label:"Province",items:e.items,value:f,setValue:g,defaultLabel:"Select a province",disabled:e.disabled||i}),(0,D.jsx)(ah,{label:"Municipality",items:h.items,value:i,setValue:j,defaultLabel:"Select a municipality",disabled:h.disabled}),(0,D.jsx)(ah,{label:"Type",items:k,value:l,setValue:m,disabled:!1}),(0,D.jsx)(aj,{label:"From",value:n,transferSelection:o}),(0,D.jsx)(aj,{label:"To",value:p,transferSelection:q}),(0,D.jsx)("h6",{children:"What's new"}),(0,D.jsx)("p",{children:"[Recap here]"}),(0,D.jsx)("h6",{children:"Timeline"}),(0,D.jsxs)("div",{className:P()("d-flex","justify-content-between"),children:[(0,D.jsx)(am,{label:"Play",items:[{content:(0,D.jsx)(ae.mz0,{}),onClickAction:function(a){return console.log(a)}},{content:"0.5X",onClickAction:function(a){return console.log(a)}},{content:"1X",onClickAction:function(a){return console.log(a)}},{content:"2X",onClickAction:function(a){return console.log(a)}},{content:(0,D.jsx)(ae.cAs,{}),onClickAction:function(a){return console.log(a)}},]}),(0,D.jsx)(ak,{label:"Save",content:(0,D.jsx)(ae.QNI,{})})]}),(0,D.jsx)("p",{children:"[Timeline here]"})]})}var au=c(8576),av=c.n(au),aw={blueJeans:"#0978AB",lightBlue:"#DDF7FF",terrain:"#ECE5E0",white:"#ffffff",onWikidata:"#C3C5C3",inContest:"#F8FF0E",photographed:"#22B8B4",interactive:"#FF004D",authorized:"#F8FF0E",mapped:"#C3C5C3"};function ax(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}}var ay=N.PUr().range([1,70]),az=function(a,b){console.log("initialize",b),b.ventagli,b.extent;var c=b.geographies;b.selectedRegion,b.selectedProvince,b.selectedMunicipality,b.typology,b.dateFrom,b.dateTo,l=N.Ys(a);var d=l.node().getBoundingClientRect();m=d.width,n=d.height,o=l.select(".bgRect"),o.empty()&&(o=l.append("rect").classed("bgRect",!0)),o.attr("fill",aw.lightBlue).attr("width",m).attr("height",n).attr("pointer-events","none"),s=l.select(".main-g"),s.empty()&&(s=l.append("g").classed("main-g",!0)),t=s.select(".g_geographies"),t.empty()&&(t=s.append("g").classed("g_geographies",!0)),y=t.select(".municipalities"),y.empty()&&(y=t.append("g").classed("municipalities",!0)),w=t.select(".provinces"),w.empty()&&(w=t.append("g").classed("provinces",!0)),u=t.select(".regions"),u.empty()&&(u=t.append("g").classed("regions",!0)),A=s.select(".g_ventagli"),A.empty()&&(A=s.append("g").classed("g_ventagli",!0)),p=N.mw4().fitSize([m,n],c.regions),q=N.l49(p),C={},r=N.sPX().scaleExtent([1,1024]).extent([[0,0],[m,n],]).on("zoom",function(a){return aB(a.transform)}),l.call(r).call(r.transform,N.CRH),aA(b)},aA=function(a){console.log("update"),ay.domain(a.extent),v=u.selectAll(".region").data(a.geographies.regions.features,function(a){return a.properties.DEN_REG}).join("path").attr("class","region").attr("fill",aw.terrain).attr("stroke",aw.white).attr("stroke-width","var(--stroke-width)").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("d",function(a){return q(a)}),a.selectedRegion&&(v.attr("opacity",.65).filter(function(b){return b.properties.DEN_REG===a.selectedRegion.label}).attr("stroke",function(a){return aw.interactive}).attr("fill","transparent").raise(),x=w.selectAll(".province").data(a.geographies.provinces.features.filter(function(b){return b.properties.COD_REG===a.selectedRegion.code}),function(a){return a.properties.COD_UTS}).join("path").attr("class","province").attr("fill",aw.terrain).attr("stroke",aw.white).attr("stroke-width","var(--stroke-width)").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("d",function(a){return q(a)})),a.selectedProvince&&(x.attr("opacity",.65).filter(function(b){return b.properties.DEN_UTS===a.selectedProvince.label}).attr("stroke",function(a){return aw.interactive}).attr("fill","transparent").raise(),z=y.selectAll(".municipality").data(a.geographies.municipalities.features.filter(function(b){return b.properties.COD_UTS===a.selectedProvince.code}),function(a){return a.properties.COMUNE}).join("path").attr("class","municipality").attr("fill",aw.terrain).attr("stroke",aw.white).attr("stroke-width","var(--stroke-width)").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("d",function(a){return q(a)}),a.selectedMunicipality&&z.filter(function(b){return b.properties.COMUNE===a.selectedMunicipality.label}).attr("stroke",function(a){return aw.interactive}).raise())};function aB(a){s.attr("transform",a),a.x,a.y;var b=a.k;document.documentElement.style.setProperty("--stroke-width",1/b),document.documentElement.style.setProperty("--label-size",10/b)}var aC=function(){B.attr("transform",function(a){return"translate(".concat(a.x,", ").concat(a.y,")")})};function aD(a){var b=a.ventagli,c=a.geographies,d=a.selectedRegion,e=a.selectedProvince,f=a.selectedMunicipality,g=a.typology,h=a.dateFrom,i=a.dateTo,j=(0,L.useRef)(),k=(0,L.useMemo)(function(){return k=[0,N.Fp7(b,function(a){return a[1][a[1].length-1][1][0].valueIncremental})]},[b]);return(0,L.useEffect)(function(){var a={ventagli:b,extent:k,geographies:c,selectedRegion:d,selectedProvince:e,selectedMunicipality:f,typology:g,dateFrom:h,dateTo:i};az(j.current,a)},[]),(0,L.useEffect)(function(){var a={ventagli:b,extent:k,geographies:c,selectedRegion:d,selectedProvince:e,selectedMunicipality:f,typology:g,dateFrom:h,dateTo:i};aA(a)},[b,d,e,f]),(0,D.jsx)("div",{className:P()(av().map),children:(0,D.jsx)("svg",{ref:j})})}N.A4v().force("x",N.RUJ(function(a){return a.x})).force("y",N.Mrm(function(a){return a.y})).force("collide",N.Hh().radius(35)).on("tick",aC).stop();var aE=c(6370),aF=[],aG=[],aH=[],aI=[{label:"All monuments"},{label:"Fortificazioni"},{label:"Quasi tutti"},{label:"Una piccola parte"},],aJ=function(){var a=(0,M.useRouter)(),b=a.asPath,c=a.basePath,d=(0,L.useState)(),e=d[0],f=d[1],g=(0,L.useState)(),h=g[0],i=g[1],j=(0,L.useState)([]),k=j[0],l=j[1],m=(0,L.useState)([]),n=m[0],o=m[1],p=(0,L.useState)([]),q=p[0],r=p[1],s=(0,L.useState)([]),t=s[0],u=s[1],v=(0,L.useState)(),w=v[0],x=v[1],y=(0,L.useState)(),z=y[0],A=y[1],B=(0,L.useState)(),C=B[0],E=B[1],F=(0,L.useState)(),G=F[0],H=F[1],J=(0,L.useState)(),O=J[0],Q=J[1],R=(0,L.useState)(),S=R[0],T=R[1];return(0,L.useEffect)(function(){var a=b.split("#")[1],d={};a&&(d=Object.fromEntries(a.split("&").map(function(a){return a.split("=").map(function(a){return decodeURIComponent(a)})})));var e=N.AVB("".concat(c,"/api-data-simulated/geometries/Reg01012022_WGS84_topoJSON.json")),g=N.AVB("".concat(c,"/api-data-simulated/geometries/ProvCM01012022_WGS84_topoJSON.json")),h=N.AVB("".concat(c,"/api-data-simulated/geometries/Com01012022_WGS84_topoJSON.json")),j=N.AVB("".concat(c,"/api-data-simulated/interval-12months.aggregation-region.json"));Promise.all([e,g,h,j]).then(function(a){var b=(0,I.Z)(a,4),c=b[0],e=b[1],g=b[2],h=b[3],j=aI;u(j);var k=Object.keys(c.objects)[0],m=(0,aE.Z)(c,c.objects[k]);l(aF=(aF=m.features.map(function(a){return{label:a.properties.DEN_REG,code:a.properties.COD_REG,type:"region",selected:!1}})).sort(function(a,b){var c=a.label.toUpperCase(),d=b.label.toUpperCase();return c<d?-1:c>d?1:0})),k=Object.keys(e.objects)[0];var n=(0,aE.Z)(e,e.objects[k]);aG=n.features.map(function(a){return{label:a.properties.DEN_UTS,code:a.properties.COD_UTS,codeRegion:a.properties.COD_REG,type:"province",selected:!1}}),k=Object.keys(g.objects)[0];var o=(0,aE.Z)(g,g.objects[k]);if(aH=o.features.map(function(a){return{label:a.properties.COMUNE,code:a.properties.PRO_COM,codeProvince:a.properties.COD_UTS,codeRegion:a.properties.COD_REG,type:"municipality",selected:!1}}),i({regions:m,provinces:n,municipalities:o}),d){d.selectedAreaType,d.selectedAreaLabel;var p=d.selectedRegion,q=d.selectedProvince,r=d.selectedMunicipality,s=d.typology,t=d.dateFrom,v=d.dateTo;p&&x(aF.find(function(a){return a.label===p})),q&&A(aG.find(function(a){return a.label===q})),r&&E(aH.find(function(a){return a.label===r})),s&&H(j.find(function(a){return a.label===s})),t&&Q(t),v&&T(v)}f(h)})},[]),(0,L.useEffect)(function(){var a=[];w&&o(aG.filter(function(a){return a.codeRegion===w.code}).sort(function(a,b){var c=a.label.toUpperCase(),d=b.label.toUpperCase();return c<d?-1:c>d?1:0}))},[w]),(0,L.useEffect)(function(){var a=[];z&&(a=(a=aH.filter(function(a){return a.codeProvince===z.code})).sort(function(a,b){var c=a.label.toUpperCase(),d=b.label.toUpperCase();return c<d?-1:c>d?1:0})),r(a)},[z]),(0,L.useEffect)(function(){var a={};w&&(a.selectedRegion=encodeURIComponent(w.label)),z&&(a.selectedProvince=encodeURIComponent(z.label)),C&&(a.selectedMunicipality=encodeURIComponent(C.label)),G&&(a.typology=encodeURIComponent(G.label)),O&&(a.dateFrom=encodeURIComponent(O)),S&&(a.dateTo=encodeURIComponent(S));var b=[];for(var c in a)b.push(c+"="+a[c]);var d="#"+b.join("&");location.replace(d)},[w,z,C,G,O,S]),(0,D.jsx)(_.Z,{className:P()(K().vizController),fluid:!0,children:(0,D.jsxs)(aa.Z,{className:P()("h-100"),children:[(0,D.jsx)(ab.Z,{className:P()("h-100"),md:3,xl:3,children:(0,D.jsx)(at,{regions:{items:k,disabled:!k.length},selectedRegion:w,setSelectedRegion:x,provinces:{items:n,disabled:!n.length},selectedProvince:z,setSelectedProvince:A,municipalities:{items:q,disabled:!q.length},selectedMunicipality:C,setSelectedMunicipality:E,typologiesList:t,typology:G,setTypology:H,dateFrom:O,setDateFrom:Q,dateTo:S,setDateTo:T})}),(0,D.jsx)(ab.Z,{className:P()("h-100"),children:e&&h&&(0,D.jsx)(aD,{ventagli:e,geographies:h,selectedRegion:w,selectedProvince:z,selectedMunicipality:C,typology:G,dateFrom:O,dateTo:S})})]})})};function aK(){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(F(),{children:(0,D.jsx)("title",{children:"Home"})}),(0,D.jsx)(aJ,{})]})}},8576:function(a){a.exports={map:"MapVentagli_map__NmyTz"}},453:function(a){a.exports={btnWlm:"NavMenu_btnWlm___ociY"}},2371:function(a){a.exports={navbar:"Navigation_navbar__clCa1",logo:"Navigation_logo__AbP0d",item:"Navigation_item__j_Te9",specificPage:"Navigation_specificPage__k2gFH"}},1174:function(a){a.exports={toolBar:"UI-Components_toolBar__KROSq",btnWlm:"UI-Components_btnWlm__51KGY"}},8804:function(a){a.exports={vizController:"VisualizationController_vizController__KxPt2"}}},function(a){a.O(0,[556,13,458,971,774,888,179],function(){var b;return a(a.s=5557)}),_N_E=a.O()}])